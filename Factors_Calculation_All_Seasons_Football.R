

weighted_mean<-function(x)
{
  a<-c(rep(0,length(x)))
  
  for(i in 1:length(x))
  {
    a[i]<-i/length(x)
  }
  
  return (sum(a*x)/length(x))
}

#setwd("C:/Users/skudriashov/Documents/Cotirovki")
setwd("W:/B2 Credit Risk/Methods and Model Development/_KUDRYASHOV_/Machine_Learning/SPORTS/Football")
cot<-read.csv("All_Season_New_SK.csv",sep=";",h=T)
cot$Date<-as.Date(cot$Date,"%d.%m.%Y")  
cot<-cot[with(cot,order(cot$Date)),]

cot$Points_1<-ifelse(cot$Goal_1>cot$Goal_2,3,ifelse(cot$Goal_1==cot$Goal_2,1,0))
cot$Points_2<-ifelse(cot$Goal_1<cot$Goal_2,3,ifelse(cot$Goal_1==cot$Goal_2,1,0))
cot$Flag_Win<-ifelse(cot$Goal_1>cot$Goal_2,1,0)
cot$Flag_Draw<-ifelse(cot$Goal_1==cot$Goal_2,1,0)
cot$Flag_Defeat<-ifelse(cot$Goal_1<cot$Goal_2,1,0)

cot$Total_more_2<-ifelse(cot$Goal_1+cot$Goal_2>2,1,0)
cot$Total_more_3<-ifelse(cot$Goal_1+cot$Goal_2>3,1,0)
cot$Total_more_4<-ifelse(cot$Goal_1+cot$Goal_2>4,1,0)
cot$Total_more_5<-ifelse(cot$Goal_1+cot$Goal_2>5,1,0)

cot$Flag_Both_scored<-ifelse(cot$Goal_1>0 & cot$Goal_2>0,1,0)

cot$Flag_Ind_total_Team1_more_0<-ifelse(cot$Goal_1>0,1,0)
cot$Flag_Ind_total_Team2_more_0<-ifelse(cot$Goal_2>0,1,0)

cot$Flag_Ind_total_Team1_more_1<-ifelse(cot$Goal_1>1,1,0)
cot$Flag_Ind_total_Team2_more_1<-ifelse(cot$Goal_2>1,1,0)

cot$Flag_1x<-ifelse(cot$Goal_1>=cot$Goal_2,1,0)
cot$Flag_2x<-ifelse(cot$Goal_1<=cot$Goal_2,1,0)

result<-data.frame()

n<-5

for (i in 1:length(unique(cot$Season_Flag)))
{
  
  cot_2<-subset(cot, cot$Season_Flag==unique(cot$Season_Flag)[i])
  
  
  for (j in 1:nrow(cot_2))
    {
    
    
    
      # ???????????????????? ?????????????????? ???????????? ?????? 1 ??????????????
    
      cot_2$Match_T1_All[j]<-nrow(rbind(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))),
                                      subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))))
    
      # ???????????????????? ?????????????????? ???????????? ?????? 2 ??????????????
      
      cot_2$Match_T2_All[j]<-nrow(rbind(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))),
                                        subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))))
    
    
      # ???????????????????? ?????????????????? ???????????????? ???????????? ?????? 1 ??????????????
      
      cot_2$Match_T1_Home[j]<-nrow(subset(cot_2, cot_2$Date<cot_2$Date[j] & cot_2$Team_1==cot_2$Team_1[j]))

    
      # ???????????????????? ?????????????????? ???????????????? ???????????? ?????? 2 ??????????????

      
      cot_2$Match_T2_Guest[j]<-nrow(subset(cot_2, cot_2$Date<cot_2$Date[j] & cot_2$Team_2==cot_2$Team_2[j]))
      
  }
  
  


########################################################################## ???????? ####################################################################
    for (j in 1:nrow(cot_2))
    {
      
      # ???????????????????? ?????????? ?????? 1 ??????????????
      
      # cot_2$Points_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Points_1),
      #           sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Points_2))/cot_2$Match_T1_All[j]
      
      # ???????????????????? ?????????? ?????? 1 ??????????????
      
      cot_2$W_Points_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Points_1,
                                               subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Points_2))
      
      
      # ???????????????????? ?????????? ?????? 2 ??????????????
      
      
      # cot_2$Points_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Points_2),
      #           sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Points_1))/cot_2$Match_T2_All[j]  
      
      # ???????????????????? ?????????? ?????? 2 ??????????????
      
      cot_2$W_Points_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Points_2,
                                                subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Points_1))
    
    # ???????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    #   cot_2$Points_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                             abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Points_1),
    #                          sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                             abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Points_2))/min(5,cot_2$Match_T1_All[j])
    #   
    #   # ???????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    #   
    #   cot_2$Points_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                           ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Points_1),
    #                              sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                           ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Points_2))/min(10,cot_2$Match_T1_All[j])
    #   
    #   # ???????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    #   
    #   cot_2$Points_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Points_1),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                            ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Points_2))/min(15,cot_2$Match_T1_All[j])
    #   
    #   cot_2$Points_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Points_1),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                            ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Points_2))/min(20,cot_2$Match_T1_All[j])
    #  
    # # ???????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    #    
    #   cot_2$Points_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                           ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Points_1),
    #                              sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                           ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Points_2))/min(5,cot_2$Match_T2_All[j])
    #   
    #   # ???????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    #   
    #   cot_2$Points_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                           ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Points_1),
    #                              sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                           ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Points_2))/min(10,cot_2$Match_T2_All[j])
    #   
    #   # ???????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    #   
    #   cot_2$Points_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Points_1),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                            ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Points_2))/min(15,cot_2$Match_T2_All[j])
    #   
    #   # ???????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    #   
    #   cot_2$Points_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Points_1),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                            ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Points_2))/min(20,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    #    
    #   cot_2$Points_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                           ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Points_1)/min(5,cot_2$Match_T1_Home[j])
    #   
    #   # ???????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    #   
    #   cot_2$Points_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Points_1)/min(10,cot_2$Match_T1_Home[j])
    #   
    #   # ???????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    #   
    #   cot_2$Points_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Points_1)/min(15,cot_2$Match_T1_Home[j])
    #   
    #   # ???????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    #   
    #   cot_2$Points_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Points_1)/min(20,cot_2$Match_T1_Home[j])
    #   
    #   
    # # ???????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    #   
    #   cot_2$Points_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                            ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Points_2)/min(5,cot_2$Match_T2_Guest[j])
    #   
    #   # ???????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    #   
    #   cot_2$Points_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Points_2)/min(10,cot_2$Match_T2_Guest[j])
    #   
    #   # ???????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    #   
    #   cot_2$Points_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Points_2)/min(15,cot_2$Match_T2_Guest[j])
    #   
    #   # ???????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    #   
    #   cot_2$Points_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Points_2)/min(20,cot_2$Match_T2_Guest[j])
      
      
      
  } 
##################################################################### ?????????????? ???????? ####################################################################
        
  for (j in 1:nrow(cot_2))
  {
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
   
    # cot_2$Plus_Goals_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Goal_1),
    #             sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Goal_2))/cot_2$Match_T1_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Plus_Goals_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Goal_1,
                                                subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Goal_2))
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    # cot_2$Plus_Goals_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Goal_2),
    #             sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Goal_1))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    cot_2$W_Plus_Goals_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Goal_2,
                                                subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Goal_1))
    
    # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Plus_Goals_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                 abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                         ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_1),
    #                            sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                 abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                         ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Goal_2))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Goals_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_1),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Goal_2))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Goals_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_1),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Goal_2))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Goals_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_1),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Goal_2))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Goals_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                 abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                         ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Goal_1),
    #                            sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                 abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                         ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_2))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Goals_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Goal_1),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_2))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Goals_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Goal_1),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_2))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Goals_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Goal_1),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_2))/min(20,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Goals_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                  abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                          ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_1)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Goals_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_1)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Goals_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_1)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Goals_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_1)/min(20,cot_2$Match_T1_Home[j])
    # 
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Goals_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                           ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_2)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Goals_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_2)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Goals_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_2)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Goals_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_2)/min(20,cot_2$Match_T2_Guest[j])
      
      
  }     
##################################################################### ?????????????????????? ???????? ####################################################################      
      for (j in 1:nrow(cot_2))
      {  
     
 # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????        
        
        # cot_2$Minus_Goals_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Goal_2),
        #           sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Goal_1))/cot_2$Match_T1_All[j]       
           
 # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????
        
        cot_2$W_Minus_Goals_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Goal_2,
                                                      subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Goal_1))
        
 # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
        
        # cot_2$Minus_Goals_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Goal_1),
        #           sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Goal_2))/cot_2$Match_T2_All[j]

 # ???????????????????? ?????????????????????? ?????????? ?????? 2 ?????????????? 
        
        cot_2$W_Minus_Goals_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Goal_1,
                                                      subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Goal_2))
 
 # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
        
 #        cot_2$Minus_Goals_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                            abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
 #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_2),
 #                                       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                            abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
 #                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Goal_1))/min(5,cot_2$Match_T1_All[j])
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
 #        
 #        cot_2$Minus_Goals_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                             abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
 #                                                     ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_2),
 #                                        sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                             abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
 #                                                     ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Goal_1))/min(10,cot_2$Match_T1_All[j])
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
 #        
 #        cot_2$Minus_Goals_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
 #                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_2),
 #                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
 #                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Goal_1))/min(15,cot_2$Match_T1_All[j])
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
 #        
 #        cot_2$Minus_Goals_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
 #                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_2),
 #                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
 #                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Goal_1))/min(20,cot_2$Match_T1_All[j])
 #        
 # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
 #        
 #        cot_2$Minus_Goals_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
 #                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Goal_2),
 #                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
 #                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_1))/min(5,cot_2$Match_T2_All[j])
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
 #        
 #        cot_2$Minus_Goals_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                             abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
 #                                                     ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Goal_2),
 #                                        sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                             abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
 #                                                     ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_1))/min(10,cot_2$Match_T2_All[j])
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
 #        
 #        cot_2$Minus_Goals_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
 #                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Goal_2),
 #                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
 #                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_1))/min(15,cot_2$Match_T2_All[j])
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
 #        
 #        cot_2$Minus_Goals_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
 #                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Goal_2),
 #                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
 #                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_1))/min(20,cot_2$Match_T2_All[j])
 #        
 #        
 # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
 #        
 #        cot_2$Minus_Goals_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                             abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
 #                                                     ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_2)/min(5,cot_2$Match_T1_Home[j])
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
 #        
 #        cot_2$Minus_Goals_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
 #                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_2)/min(10,cot_2$Match_T1_Home[j])
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
 #        
 #        cot_2$Minus_Goals_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                               abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
 #                                                       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_2)/min(15,cot_2$Match_T1_Home[j])
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
 #        
 #        cot_2$Minus_Goals_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                               abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
 #                                                       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_2)/min(20,cot_2$Match_T1_Home[j])
 #        
 # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
 #        
 #        cot_2$Minus_Goals_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                              abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
 #                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_1)/min(5,cot_2$Match_T2_Guest[j])
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
 #        
 #        cot_2$Minus_Goals_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                               abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
 #                                                       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_1)/min(10,cot_2$Match_T2_Guest[j])
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
 #        
 #        cot_2$Minus_Goals_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                                abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
 #                                                        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_1)/min(15,cot_2$Match_T2_Guest[j]) 
 #        
 #        # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
 #        
 #        cot_2$Minus_Goals_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
 #                                                                abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
 #                                                        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_1)/min(20,cot_2$Match_T2_Guest[j])
        
        
      }
    
    
##################################################################### ???????????? ####################################################################    

##################################################################### ???????????? 1.5 ?? ####################################################################     
        
    for (j in 1:nrow(cot_2))
    { 

      # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ?????? 1 ??????????????        
      
      # cot_2$Total_More_2_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_2),
      #       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_2))/cot_2$Match_T1_All[j]           
      
      # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ?????? 1 ?????????????? 
      
      
      cot_2$W_Total_More_2_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_2,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_2))
      
      # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ?????? 2 ?????????????? 
      
      # cot_2$Total_More_2_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_2),
      #       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_2))/cot_2$Match_T2_All[j]  
      
      # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ?????? 2 ?????????????? 
      
      cot_2$W_Total_More_2_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_2,
                                                      subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_2))
      
      # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
      # 
      # cot_2$Total_More_2_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
      #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_2),
      #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
      #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_2))/min(5,cot_2$Match_T1_All[j])
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
      # 
      # cot_2$Total_More_2_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
      #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_2),
      #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
      #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_2))/min(10,cot_2$Match_T1_All[j])
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
      # 
      # cot_2$Total_More_2_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
      #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_2),
      #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
      #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_2))/min(15,cot_2$Match_T1_All[j])
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
      # 
      # cot_2$Total_More_2_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
      #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_2),
      #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
      #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_2))/min(20,cot_2$Match_T1_All[j])
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
      # 
      # cot_2$Total_More_2_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
      #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_2),
      #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
      #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_2))/min(5,cot_2$Match_T2_All[j])  
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
      # 
      # cot_2$Total_More_2_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
      #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_2),
      #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
      #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_2))/min(10,cot_2$Match_T2_All[j]) 
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
      # 
      # cot_2$Total_More_2_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
      #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_2),
      #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
      #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_2))/min(15,cot_2$Match_T2_All[j]) 
      # 
      #  # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
      # 
      # cot_2$Total_More_2_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
      #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_2),
      #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
      #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_2))/min(20,cot_2$Match_T2_All[j]) 
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
      # 
      # cot_2$Total_More_2_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
      #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_2)/min(5,cot_2$Match_T1_Home[j]) 
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
      # 
      # cot_2$Total_More_2_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
      #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_2)/min(10,cot_2$Match_T1_Home[j]) 
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
      # 
      # cot_2$Total_More_2_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
      #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_2)/min(15,cot_2$Match_T1_Home[j]) 
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
      # 
      # cot_2$Total_More_2_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
      #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_2)/min(20,cot_2$Match_T1_Home[j]) 
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
      # 
      # cot_2$Total_More_2_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
      #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_2)/min(5,cot_2$Match_T2_Guest[j])   
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
      # 
      # cot_2$Total_More_2_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
      #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_2)/min(10,cot_2$Match_T2_Guest[j])   
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
      # 
      # cot_2$Total_More_2_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
      #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_2)/min(15,cot_2$Match_T2_Guest[j])  
      # 
      # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
      # 
      # cot_2$Total_More_2_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
      #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
      #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_2)/min(20,cot_2$Match_T2_Guest[j])  
      
    }
      
##################################################################### ???????????? 2.5 ?? ####################################################################       
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ?????? 1 ??????????????        
    
    # cot_2$Total_more_3_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_3),
    #           sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_3))/cot_2$Match_T1_All[j]           
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ?????? 1 ?????????????? 
    
    cot_2$W_Total_more_3_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_3,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_3))
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ?????? 2 ?????????????? 
    
    # cot_2$Total_more_3_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_3),
    #           sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_3))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ?????? 2 ?????????????? 
    
    cot_2$W_Total_more_3_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_3,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_3))
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Total_more_3_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_3),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_3))/min(5,cot_2$Match_T1_All[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_more_3_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_3),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_3))/min(10,cot_2$Match_T1_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_more_3_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_3),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_3))/min(15,cot_2$Match_T1_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_more_3_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_3),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_3))/min(20,cot_2$Match_T1_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_3_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_3),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_3))/min(5,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_3_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_3),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_3))/min(10,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_3_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_3),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_3))/min(15,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_3_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_3),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_3))/min(20,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_3_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_3)/min(5,cot_2$Match_T1_Home[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_3_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_3)/min(10,cot_2$Match_T1_Home[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_3_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_3)/min(15,cot_2$Match_T1_Home[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_3_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_3)/min(20,cot_2$Match_T1_Home[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_3_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_3)/min(5,cot_2$Match_T2_Guest[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_3_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_3)/min(10,cot_2$Match_T2_Guest[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_3_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_3)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_3_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_3)/min(20,cot_2$Match_T2_Guest[j])
    
  }
  
##################################################################### ???????????? 3.5 ?? ####################################################################   
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ?????? 1 ??????????????        
    
    # cot_2$Total_more_4_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_4),
    #          sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_4))/cot_2$Match_T1_All[j]           
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ?????? 1 ?????????????? 
    
    cot_2$W_Total_more_4_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_4,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_4))
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ?????? 2 ?????????????? 
    
    # cot_2$Total_more_4_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_4),
    #         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_4))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ?????? 2 ?????????????? 
    
    cot_2$W_Total_more_4_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_4,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_4))
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_more_4_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_4),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_4))/min(5,cot_2$Match_T1_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_more_4_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_4),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_4))/min(10,cot_2$Match_T1_All[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_more_4_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_4),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_4))/min(15,cot_2$Match_T1_All[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_more_4_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_4),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_4))/min(20,cot_2$Match_T1_All[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_4_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_4),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_4))/min(5,cot_2$Match_T2_All[j])   
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_4_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_4),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_4))/min(10,cot_2$Match_T2_All[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_4_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_4),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_4))/min(15,cot_2$Match_T2_All[j])   
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_4_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_4),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_4))/min(20,cot_2$Match_T2_All[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_4_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_4)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_4_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_4)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_4_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_4)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_4_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_4)/min(20,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_4_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_4)/min(5,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_4_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_4)/min(10,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_4_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_4)/min(15,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_4_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_4)/min(20,cot_2$Match_T2_Guest[j])
    
  }

  
  ##################################################################### ???????????? 4.5 ?? ####################################################################   
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ?????? 1 ??????????????        
    
    # cot_2$Total_more_5_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_5),
    #        sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_5))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ?????? 1 ?????????????? 
    
    cot_2$W_Total_more_5_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_5,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_5))
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ?????? 2 ?????????????? 
    
    # cot_2$Total_more_5_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_5),
    #       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_5))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ?????? 2 ?????????????? 
    
    cot_2$W_Total_more_5_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_5,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_5))
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_more_5_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_5),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_5))/min(5,cot_2$Match_T1_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_more_5_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_5),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_5))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_more_5_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_5),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_5))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_more_5_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_5),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_5))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_5_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_5),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_5))/min(5,cot_2$Match_T2_All[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_5_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_5),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_5))/min(10,cot_2$Match_T2_All[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_5_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_5),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_5))/min(15,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_more_5_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_5),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_5))/min(20,cot_2$Match_T2_All[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_5_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_5)/min(5,cot_2$Match_T1_Home[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_5_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_5)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_5_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_5)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_more_5_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_5)/min(20,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_5_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_5)/min(5,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_5_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_5)/min(10,cot_2$Match_T2_Guest[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_5_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_5)/min(15,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 4.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_more_5_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_5)/min(20,cot_2$Match_T2_Guest[j])  
    
  }
  
  
##################################################################### ???????????????????????????? ???????????? 0.5 ?? ####################################################################   
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 1 ??????????????        
    
    # cot_2$Ind_Total_more_0_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Ind_total_Team1_more_0),
    #    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Ind_total_Team2_more_0))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 1 ?????????????? 
    
    cot_2$W_Ind_Total_more_0_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Ind_total_Team1_more_0,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Ind_total_Team2_more_0))
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 2 ?????????????? 
    
    # cot_2$Ind_Total_more_0_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Ind_total_Team2_more_0),
    #    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Ind_total_Team1_more_0))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 2 ?????????????? 
    
    cot_2$W_Ind_Total_more_0_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Ind_total_Team2_more_0,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Ind_total_Team1_more_0))
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Ind_Total_more_0_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_0),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_0))/min(5,cot_2$Match_T1_All[j])  
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Ind_Total_more_0_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_0),
    #                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_0))/min(10,cot_2$Match_T1_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Ind_Total_more_0_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_0),
    #                                       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_0))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Ind_Total_more_0_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_0),
    #                                       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_0))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Ind_Total_more_0_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_0),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_0))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Ind_Total_more_0_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_0),
    #                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_0))/min(10,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Ind_Total_more_0_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_0),
    #                                       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_0))/min(15,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Ind_Total_more_0_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_0),
    #                                       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_0))/min(20,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Ind_Total_more_0_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_0)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Ind_Total_more_0_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_0)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Ind_Total_more_0_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                             abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                     ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_0)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Ind_Total_more_0_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                             abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                     ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_0)/min(20,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Ind_Total_more_0_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_0)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Ind_Total_more_0_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                             abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                     ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_0)/min(10,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Ind_Total_more_0_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                              abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_0)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Ind_Total_more_0_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                              abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_0)/min(20,cot_2$Match_T2_Guest[j])
    
  }
  
##################################################################### ???????????????????????????? ???????????? 1.5 ?? #################################################################### 
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ?????? 1 ??????????????        
    
    # cot_2$Ind_Total_more_1_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Ind_total_Team1_more_1),
    #     sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Ind_total_Team2_more_1))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ?????? 1 ?????????????? 
    
    cot_2$W_Ind_Total_more_1_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Ind_total_Team1_more_1,
                                                        subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Ind_total_Team2_more_1))
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ?????? 2 ?????????????? 
    
    
    # cot_2$Ind_Total_more_1_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Ind_total_Team2_more_1),
    #     sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Ind_total_Team1_more_1))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ?????? 2 ?????????????? 
    
    cot_2$W_Ind_Total_more_1_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Ind_total_Team2_more_1,
                                                        subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Ind_total_Team1_more_1))
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Ind_Total_more_1_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_1),
    #                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_1))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Ind_Total_more_1_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_1),
    #                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_1))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Ind_Total_more_1_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_1),
    #                                       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_1))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Ind_Total_more_1_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_1),
    #                                       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_1))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Ind_Total_more_1_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_1),
    #                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_1))/min(5,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Ind_Total_more_1_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_1),
    #                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_1))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Ind_Total_more_1_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_1),
    #                                       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_1))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Ind_Total_more_1_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_1),
    #                                       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_1))/min(20,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Ind_Total_more_1_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_1)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Ind_Total_more_1_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_1)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Ind_Total_more_1_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                             abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                     ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_1)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Ind_Total_more_1_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                             abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                     ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_1)/min(20,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Ind_Total_more_1_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                             abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                     ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_1)/min(5,cot_2$Match_T2_Guest[j])  
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Ind_Total_more_1_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                             abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                     ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_1)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Ind_Total_more_1_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                              abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_1)/min(15,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Ind_Total_more_1_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                              abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_1)/min(20,cot_2$Match_T2_Guest[j])
    
  }
  
##################################################################### ?????? ???????????? #################################################################### 
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ??????????????        
    
    # cot_2$Both_Scored_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Both_scored),
    #            sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Both_scored))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ??????????????
    
    cot_2$W_Both_Scored_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Both_scored,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Both_scored))
    
    # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 2 ?????????????? 
    
    
    # cot_2$Both_Scored_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Both_scored),
    #            sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Both_scored))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 2 ??????????????
    
    cot_2$W_Both_Scored_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Both_scored,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Both_scored))
    
    # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Both_Scored_1_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Both_scored),
    #                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Both_scored))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Both_Scored_1_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Both_scored),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Both_scored))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Both_Scored_1_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Both_scored),
    #                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Both_scored))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Both_Scored_1_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Both_scored),
    #                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Both_scored))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 2 ?????????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Both_Scored_1_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Both_scored),
    #                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Both_scored))/min(5,cot_2$Match_T2_All[j])  
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 2 ?????????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Both_Scored_1_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Both_scored),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Both_scored))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 2 ?????????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Both_Scored_1_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Both_scored),
    #                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Both_scored))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 2 ?????????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Both_Scored_1_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Both_scored),
    #                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Both_scored))/min(20,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Both_Scored_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                            abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Both_scored)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Both_Scored_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Both_scored)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Both_Scored_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Both_scored)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Both_Scored_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Both_scored)/min(20,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Both_Scored_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                             abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                     ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Both_scored)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Both_Scored_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Both_scored)/min(10,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Both_Scored_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Both_scored)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ???????????? ?? ???????????? ?????? ?? = 1 ?????? 1 ?????????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Both_Scored_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Both_scored)/min(20,cot_2$Match_T2_Guest[j])
    
  }  
  
  
##################################################################### ???????????? ####################################################################  
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ?????????? ?????? 1 ??????????????        
    
    # cot_2$Total_Win_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_Win),
    #         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_Defeat))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Total_Win_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_Win,
                                                 subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_Defeat))
    
    # ???????????????????? ?????????? ?????? 2 ?????????????? 
    
    
    # cot_2$Total_Win_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_Defeat),
    #         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_Win))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Total_Win_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_Defeat,
                                                 subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_Win))
    
    # ???????????????????? ?????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    
    # cot_2$Total_Win_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Win),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Defeat))/min(min(cot_2$Match_T1_All[j],10),max(cot_2$Match_T1_All[j],10))
    # 
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Win_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Win),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Defeat))/min(min(cot_2$Match_T1_All[j],5),max(cot_2$Match_T1_All[j],5))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Win_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Win),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Defeat))/min(min(cot_2$Match_T1_All[j],15),max(cot_2$Match_T1_All[j],15))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Win_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Win),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Defeat))/min(min(cot_2$Match_T1_All[j],20),max(cot_2$Match_T1_All[j],20))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Win_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Win),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Defeat))/min(min(cot_2$Match_T2_All[j],10),max(cot_2$Match_T2_All[j],10))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Win_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Win),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Defeat))/min(min(cot_2$Match_T2_All[j],5),max(cot_2$Match_T2_All[j],5))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Win_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Win),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Defeat))/min(min(cot_2$Match_T2_All[j],15),max(cot_2$Match_T2_All[j],15))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Win_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Win),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Defeat))/min(min(cot_2$Match_T2_All[j],20),max(cot_2$Match_T2_All[j],20))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Win_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #         ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Win)/min(min(cot_2$Match_T1_Home[j],10),max(cot_2$Match_T1_Home[j],10))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Win_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #         ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Win)/min(min(cot_2$Match_T1_Home[j],5),max(cot_2$Match_T1_Home[j],5))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Win_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #         ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Win)/min(min(cot_2$Match_T1_Home[j],15),max(cot_2$Match_T1_Home[j],15))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Win_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #         ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Win)/min(min(cot_2$Match_T1_Home[j],20),max(cot_2$Match_T1_Home[j],20))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Win_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #         ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Defeat)/min(min(cot_2$Match_T2_Guest[j],10),max(cot_2$Match_T2_Guest[j],10))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Win_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #         ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Defeat)/min(min(cot_2$Match_T2_Guest[j],5),max(cot_2$Match_T2_Guest[j],5))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Win_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #         ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Defeat)/min(min(cot_2$Match_T2_Guest[j],15),max(cot_2$Match_T2_Guest[j],15))
    # 
    # # ???????????????????? ?????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Win_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #         ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Defeat)/min(min(cot_2$Match_T2_Guest[j],20),max(cot_2$Match_T2_Guest[j],20))
    
  }  
  
  
##################################################################### ?????????? ####################################################################  
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?????? 1 ??????????????        
    
    # cot_2$Total_Draw_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_Draw),
    #       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_Draw))/cot_2$Match_T1_All[j]           
    
    # ???????????????????? ???????????? ?????? 1 ?????????????? 
    
    cot_2$W_Total_Draw_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_Draw,
                                                 subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_Draw))
    
    # ???????????????????? ???????????? ?????? 2 ?????????????? 
    
    # 
    # cot_2$Total_Draw_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_Draw),
    #       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_Draw))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ???????????? ?????? 2 ?????????????? 
    
    cot_2$W_Total_Draw_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_Draw,
                                                 subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_Draw))
    
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Draw_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #         ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Draw))/min(min(cot_2$Match_T1_All[j],10),max(cot_2$Match_T1_All[j],10))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Draw_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #         ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Draw))/min(min(cot_2$Match_T1_All[j],5),max(cot_2$Match_T1_All[j],5))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Draw_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #         ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Draw))/min(min(cot_2$Match_T1_All[j],15),max(cot_2$Match_T1_All[j],15))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Draw_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #         ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Draw))/min(min(cot_2$Match_T1_All[j],20),max(cot_2$Match_T1_All[j],20))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Draw_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Draw))/min(min(cot_2$Match_T1_All[j],10),max(cot_2$Match_T1_All[j],10))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Draw_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Draw))/min(min(cot_2$Match_T1_All[j],5),max(cot_2$Match_T1_All[j],5))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Draw_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Draw))/min(min(cot_2$Match_T1_All[j],15),max(cot_2$Match_T1_All[j],15))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Draw_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Draw))/min(min(cot_2$Match_T1_All[j],20),max(cot_2$Match_T1_All[j],20))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Draw_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Draw),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Draw))/min(min(cot_2$Match_T2_All[j],10),max(cot_2$Match_T2_All[j],10))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Draw_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Draw),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Draw))/min(min(cot_2$Match_T2_All[j],5),max(cot_2$Match_T2_All[j],5))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Draw_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Draw),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Draw))/min(min(cot_2$Match_T2_All[j],15),max(cot_2$Match_T2_All[j],15))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Draw_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Draw),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Draw))/min(min(cot_2$Match_T2_All[j],20),max(cot_2$Match_T2_All[j],20))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Draw_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #          ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw)/min(min(cot_2$Match_T1_Home[j],10),max(cot_2$Match_T1_Home[j],10))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Draw_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #          ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw)/min(min(cot_2$Match_T1_Home[j],5),max(cot_2$Match_T1_Home[j],5))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Draw_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #          ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw)/min(min(cot_2$Match_T1_Home[j],15),max(cot_2$Match_T1_Home[j],15))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Draw_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #          ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Draw)/min(min(cot_2$Match_T1_Home[j],20),max(cot_2$Match_T1_Home[j],20))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Draw_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Draw)/min(min(cot_2$Match_T2_Guest[j],10),max(cot_2$Match_T2_Guest[j],10))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Draw_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Draw)/min(min(cot_2$Match_T2_Guest[j],5),max(cot_2$Match_T2_Guest[j],5))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Draw_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Draw)/min(min(cot_2$Match_T2_Guest[j],15),max(cot_2$Match_T2_Guest[j],15))
    # 
    # # ???????????????????? ???????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Draw_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #          ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Draw)/min(min(cot_2$Match_T2_Guest[j],20),max(cot_2$Match_T2_Guest[j],20))
    
  }  
  
##################################################################### ?????????????????? ####################################################################  
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ?????????????????? ?????? 1 ??????????????        
    
    # cot_2$Total_Defeat_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_Defeat),
    #      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_Win))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ?????????????????? ?????? 1 ?????????????? 
    
    cot_2$W_Total_Defeat_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_Defeat,
                                                  subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_Win))
    
    # ???????????????????? ?????????????????? ?????? 2 ?????????????? 
    
    # 
    # cot_2$Total_Defeat_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_Win),
    #      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_Defeat))/cot_2$Match_T2_All[j]   
    
    # ???????????????????? ?????????????????? ?????? 2 ?????????????? 
    
    cot_2$W_Total_Defeat_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_Win,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_Defeat))
    
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Defeat_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Defeat),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Win))/min(min(cot_2$Match_T1_All[j],10),max(cot_2$Match_T1_All[j],10))
    # 
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Defeat_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Defeat),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Win))/min(min(cot_2$Match_T1_All[j],5),max(cot_2$Match_T1_All[j],5))
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Defeat_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Defeat),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Win))/min(min(cot_2$Match_T1_All[j],15),max(cot_2$Match_T1_All[j],15))
    # 
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_Defeat_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Defeat),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Win))/min(min(cot_2$Match_T1_All[j],20),max(cot_2$Match_T1_All[j],20))
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Defeat_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Defeat),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Win))/min(min(cot_2$Match_T2_All[j],10),max(cot_2$Match_T2_All[j],10))
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Defeat_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Defeat),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Win))/min(min(cot_2$Match_T2_All[j],5),max(cot_2$Match_T2_All[j],5)) 
    # 
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Defeat_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Defeat),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Win))/min(min(cot_2$Match_T2_All[j],15),max(cot_2$Match_T2_All[j],15))
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_Defeat_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Defeat),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Win))/min(min(cot_2$Match_T2_All[j],20),max(cot_2$Match_T2_All[j],20)) 
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Defeat_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #        ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Defeat)/min(min(cot_2$Match_T1_Home[j],10),max(cot_2$Match_T1_Home[j],10))
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Defeat_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #        ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Defeat)/min(min(cot_2$Match_T1_Home[j],5),max(cot_2$Match_T1_Home[j],5))
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Defeat_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #        ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Defeat)/min(min(cot_2$Match_T1_Home[j],15),max(cot_2$Match_T1_Home[j],15))
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_Defeat_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #        ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Defeat)/min(min(cot_2$Match_T1_Home[j],20),max(cot_2$Match_T1_Home[j],20))
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Defeat_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Win)/min(min(cot_2$Match_T2_Guest[j],10),max(cot_2$Match_T2_Guest[j],10))
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Defeat_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Win)/min(min(cot_2$Match_T2_Guest[j],5),max(cot_2$Match_T2_Guest[j],5))
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Defeat_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Win)/min(min(cot_2$Match_T2_Guest[j],15),max(cot_2$Match_T2_Guest[j],15))
    # 
    # # ???????????????????? ?????????????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_Defeat_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Win)/min(min(cot_2$Match_T2_Guest[j],20),max(cot_2$Match_T2_Guest[j],20)) 
    
  }
  
  
  
##################################################################### 1X ####################################################################  
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ?????? 1 ??????????????        
    
    # cot_2$Total_1X_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_1x),
    #      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_2x))/cot_2$Match_T1_All[j]             
    
    # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ?????? 1 ?????????????? 
    
    cot_2$W_Total_1X_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_1x,
                                                subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_2x))
    
    # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ?????? 2 ?????????????? 
    
    # cot_2$Total_1X_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_2x),
    #       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_1x))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ?????? 2 ?????????????? 
    
    cot_2$W_Total_1X_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_2x,
                                                subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_1x))
    
    # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    
    # cot_2$Total_1X_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_1x),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_2x))/min(min(cot_2$Match_T1_All[j],10),max(cot_2$Match_T1_All[j],10))
    # 
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_1X_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_1x),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_2x))/min(min(cot_2$Match_T1_All[j],5),max(cot_2$Match_T1_All[j],5))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_1X_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                           ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_1x),
    #                              sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_2x))/min(min(cot_2$Match_T1_All[j],15),max(cot_2$Match_T1_All[j],15))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_1X_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_1x),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_2x))/min(min(cot_2$Match_T1_All[j],20),max(cot_2$Match_T1_All[j],20))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_1X_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_1x),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_2x))/min(min(cot_2$Match_T2_All[j],10),max(cot_2$Match_T2_All[j],10))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_1X_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_1x),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_2x))/min(min(cot_2$Match_T2_All[j],5),max(cot_2$Match_T2_All[j],5))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_1X_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                           ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_1x),
    #                              sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_2x))/min(min(cot_2$Match_T2_All[j],15),max(cot_2$Match_T2_All[j],15))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_1X_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_1x),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_2x))/min(min(cot_2$Match_T2_All[j],20),max(cot_2$Match_T2_All[j],20))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_1X_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_1x)/min(min(cot_2$Match_T1_Home[j],10),max(cot_2$Match_T1_Home[j],10))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_1X_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_1x)/min(min(cot_2$Match_T1_Home[j],5),max(cot_2$Match_T1_Home[j],5))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_1X_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_1x)/min(min(cot_2$Match_T1_Home[j],15),max(cot_2$Match_T1_Home[j],15))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_1X_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_1x)/min(min(cot_2$Match_T1_Home[j],20),max(cot_2$Match_T1_Home[j],20))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_1X_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_2x)/min(min(cot_2$Match_T2_Guest[j],10),max(cot_2$Match_T2_Guest[j],10))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_1X_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_2x)/min(min(cot_2$Match_T2_Guest[j],5),max(cot_2$Match_T2_Guest[j],5))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_1X_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_2x)/min(min(cot_2$Match_T2_Guest[j],15),max(cot_2$Match_T2_Guest[j],15))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 1?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_1X_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_2x)/min(min(cot_2$Match_T2_Guest[j],20),max(cot_2$Match_T2_Guest[j],20))
    
  }
  
  
  ##################################################################### 2X ####################################################################  
  
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ?????? 1 ??????????????        
    
    # cot_2$Total_2X_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_2x),
    #       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_1x))/cot_2$Match_T1_All[j]              
    
    # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ?????? 1 ?????????????? 
    
    cot_2$W_Total_2X_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_2x,
                                                subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_1x))
    
    # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ?????? 2 ?????????????? 
    # 
    # cot_2$Total_2X_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_1x),
    #       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_2x))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ?????? 2 ?????????????? 
    
    cot_2$W_Total_2X_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_1x,
                                                subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_2x))
    
    # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_2X_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_2x),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_1x))/min(min(cot_2$Match_T1_All[j],10),max(cot_2$Match_T1_All[j],10))
    # 
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_2X_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_2x),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_1x))/min(min(cot_2$Match_T1_All[j],5),max(cot_2$Match_T1_All[j],5))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_2X_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                           ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_2x),
    #                              sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_1x))/min(min(cot_2$Match_T1_All[j],15),max(cot_2$Match_T1_All[j],15))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Total_2X_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_2x),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #       ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_1x))/min(min(cot_2$Match_T1_All[j],20),max(cot_2$Match_T1_All[j],20))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_2X_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_2x),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_1x))/min(min(cot_2$Match_T2_All[j],10),max(cot_2$Match_T2_All[j],10))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_2X_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_2x),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_1x))/min(min(cot_2$Match_T2_All[j],5),max(cot_2$Match_T2_All[j],5))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_2X_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                           ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_2x),
    #                              sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                   abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_1x))/min(min(cot_2$Match_T2_All[j],15),max(cot_2$Match_T2_All[j],15))
    # 
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Total_2X_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_2x),
    #                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_1x))/min(min(cot_2$Match_T2_All[j],20),max(cot_2$Match_T2_All[j],20))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_2X_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_2x)/min(min(cot_2$Match_T1_Home[j],10),max(cot_2$Match_T1_Home[j],10))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_2X_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_2x)/min(min(cot_2$Match_T1_Home[j],5),max(cot_2$Match_T1_Home[j],5))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_2X_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                    abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_2x)/min(min(cot_2$Match_T1_Home[j],15),max(cot_2$Match_T1_Home[j],15))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Total_2X_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_2x)/min(min(cot_2$Match_T1_Home[j],20),max(cot_2$Match_T1_Home[j],20))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_2X_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_1x)/min(min(cot_2$Match_T2_Guest[j],10),max(cot_2$Match_T2_Guest[j],10))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_2X_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_1x)/min(min(cot_2$Match_T2_Guest[j],5),max(cot_2$Match_T2_Guest[j],5))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_2X_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_1x)/min(min(cot_2$Match_T2_Guest[j],15),max(cot_2$Match_T2_Guest[j],15))
    # 
    # # ???????????????????? ???????????? ?? ???????????? 2?? = 1 ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Total_2X_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_1x)/min(min(cot_2$Match_T2_Guest[j],20),max(cot_2$Match_T2_Guest[j],20))
    
  }
  
  for (j in 1:nrow(cot_2))
  {
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    # cot_2$Plus_HGoals_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HTHG),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HTAG))/cot_2$Match_T1_All[j]  
    # 
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Plus_HGoals_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HTHG,
                                                 subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HTAG))
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Plus_HGoals_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HTAG),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HTHG))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    cot_2$W_Plus_HGoals_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HTAG,
                                                 subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HTHG))
    
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_HGoals_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTHG),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HTAG))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_HGoals_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTHG),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HTAG))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_HGoals_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTHG),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HTAG))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_HGoals_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTHG),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HTAG))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_HGoals_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HTHG),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTAG))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_HGoals_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HTHG),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTAG))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_HGoals_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HTHG),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTAG))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_HGoals_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HTHG),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTAG))/min(20,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_HGoals_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTHG)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_HGoals_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTHG)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_HGoals_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTHG)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_HGoals_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTHG)/min(20,cot_2$Match_T1_Home[j])
    # 
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_HGoals_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_HGoals_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_HGoals_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_HGoals_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG)/min(20,cot_2$Match_T2_Guest[j])
    
    
    
  }
  
  for (j in 1:nrow(cot_2))
  {  
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????        
    
    # cot_2$Minus_HGoals_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HTAG),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HTHG))/cot_2$Match_T1_All[j]       
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Minus_HGoals_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HTAG,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HTHG))
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Minus_HGoals_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HTHG),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HTAG))/cot_2$Match_T2_All[j]
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    cot_2$W_Minus_HGoals_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HTHG,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HTAG))
    
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_HGoals_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTAG),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HTHG))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_HGoals_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTAG),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HTHG))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_HGoals_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTAG),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HTHG))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_HGoals_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTAG),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HTHG))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_HGoals_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HTAG),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_HGoals_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HTAG),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_HGoals_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HTAG),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_HGoals_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HTAG),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG))/min(20,cot_2$Match_T2_All[j])
    # 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_HGoals_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTAG)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_HGoals_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTAG)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_HGoals_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTAG)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_HGoals_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HTAG)/min(20,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_HGoals_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_HGoals_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_HGoals_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_HGoals_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HTHG)/min(20,cot_2$Match_T2_Guest[j])
    
    
  }
  
  
  
  for (j in 1:nrow(cot_2))
  {
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    # cot_2$Plus_Shots_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HS),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AS))/cot_2$Match_T1_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Plus_Shots_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HS,
                                                  subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AS))
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Plus_Shots_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AS),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HS))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    cot_2$W_Plus_Shots_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AS,
                                                  subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HS))
    
    # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Plus_Shots_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HS),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AS))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Shots_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HS),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AS))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Shots_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HS),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AS))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Shots_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HS),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AS))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Shots_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HS),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AS))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Shots_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HS),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AS))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Shots_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HS),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AS))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Shots_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HS),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AS))/min(20,cot_2$Match_T2_All[j])
    # 
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Shots_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HS)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Shots_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HS)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Shots_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HS)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Shots_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HS)/min(20,cot_2$Match_T1_Home[j])
    # 
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Shots_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AS)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Shots_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AS)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Shots_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AS)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Shots_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AS)/min(20,cot_2$Match_T2_Guest[j])
    
    
    
  } 
  
  for (j in 1:nrow(cot_2))
  {  
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????        
    
    # cot_2$Minus_Shots_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AS),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HS))/cot_2$Match_T1_All[j]       
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ?????????????? 
    
    cot_2$W_Minus_Shots_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AS,
                                                  subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HS))
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Minus_Shots_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HS),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AS))/cot_2$Match_T2_All[j]
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ?????????????? 
    
    cot_2$W_Minus_Shots_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HS,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AS))
    
    # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Minus_Shots_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AS),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HS))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_Shots_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AS),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HS))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_Shots_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AS),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HS))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_Shots_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AS),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HS))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Shots_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AS),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HS))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Shots_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AS),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HS))/min(10,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Shots_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AS),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HS))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Shots_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AS),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HS))/min(20,cot_2$Match_T2_All[j]) 
    # 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_Shots_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AS)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_Shots_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AS)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_Shots_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AS)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_Shots_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AS)/min(20,cot_2$Match_T1_Home[j])
    # 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Shots_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HS)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Shots_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HS)/min(10,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Shots_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HS)/min(15,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Shots_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HS)/min(20,cot_2$Match_T2_Guest[j])
    
    
  }
  
  for (j in 1:nrow(cot_2))
  {
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    # cot_2$Plus_TShots_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HST),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AST))/cot_2$Match_T1_All[j]  
    # 
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Plus_TShots_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HST,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AST))
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Plus_TShots_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AST),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HST))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    cot_2$W_Plus_TShots_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AST,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HST))
    
    # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Plus_TShots_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HST),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AST))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_TShots_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HST),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AST))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_TShots_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HST),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AST))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_TShots_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HST),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AST))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_TShots_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HST),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AST))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_TShots_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HST),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AST))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_TShots_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HST),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AST))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_TShots_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HST),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AST))/min(20,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_TShots_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HST)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_TShots_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HST)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_TShots_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HST)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_TShots_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HST)/min(20,cot_2$Match_T1_Home[j])
    # 
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_TShots_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AST)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_TShots_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AST)/min(10,cot_2$Match_T2_Guest[j])
    # 
    #  # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_TShots_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AST)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_TShots_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AST)/min(20,cot_2$Match_T2_Guest[j])
    
    
    
  }
  
  
  for (j in 1:nrow(cot_2))
  {  
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????        
    
    # cot_2$Minus_TShots_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AST),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HST))/cot_2$Match_T1_All[j]       
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Minus_TShots_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AST,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HST))
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Minus_TShots_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HST),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AST))/cot_2$Match_T2_All[j]
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    cot_2$W_Minus_TShots_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HST,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AST))
    
    # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Minus_TShots_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AST),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HST))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_TShots_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AST),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HST))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_TShots_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AST),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HST))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_TShots_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AST),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HST))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_TShots_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AST),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HST))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_TShots_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AST),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HST))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_TShots_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AST),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HST))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_TShots_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AST),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HST))/min(20,cot_2$Match_T2_All[j])
    # 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_TShots_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AST)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_TShots_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AST)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_TShots_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AST)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_TShots_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AST)/min(20,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_TShots_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HST)/min(5,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_TShots_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HST)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_TShots_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HST)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_TShots_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HST)/min(20,cot_2$Match_T2_Guest[j])
    
    
  }
  
  for (j in 1:nrow(cot_2))
  {
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    # cot_2$Plus_Fouls_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HF),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AF))/cot_2$Match_T1_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Plus_Fouls_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HF,
                                                  subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AF))
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Plus_Fouls_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AF),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HF))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    cot_2$W_Plus_Fouls_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AF,
                                                  subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HF))
    
    # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Plus_Fouls_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HF),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AF))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Fouls_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HF),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AF))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Fouls_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HF),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AF))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Fouls_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HF),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AF))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Fouls_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HF),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AF))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Fouls_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HF),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AF))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Fouls_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HF),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AF))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Fouls_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HF),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AF))/min(20,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Fouls_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HF)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Fouls_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HF)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Fouls_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HF)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Fouls_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HF)/min(20,cot_2$Match_T1_Home[j])
    # 
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Fouls_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AF)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Fouls_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AF)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Fouls_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AF)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Fouls_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AF)/min(20,cot_2$Match_T2_Guest[j])
    
    
    
  }
  
  
  for (j in 1:nrow(cot_2))
  {  
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????        
    
    # cot_2$Minus_Fouls_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AF),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HF))/cot_2$Match_T1_All[j]       
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????  
    
    cot_2$W_Minus_Fouls_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AF,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HF))
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Minus_Fouls_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HF),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AF))/cot_2$Match_T2_All[j]
    # 
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????  
    
    cot_2$W_Minus_Fouls_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HF,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AF))
    
    # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Minus_Fouls_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AF),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HF))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_Fouls_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AF),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HF))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_Fouls_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AF),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HF))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_Fouls_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AF),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HF))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Fouls_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AF),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HF))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Fouls_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AF),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HF))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Fouls_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AF),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HF))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Fouls_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AF),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HF))/min(20,cot_2$Match_T2_All[j])
    # 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_Fouls_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AF)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_Fouls_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AF)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_Fouls_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AF)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_Fouls_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AF)/min(20,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Fouls_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HF)/min(5,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Fouls_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HF)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Fouls_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HF)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Fouls_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HF)/min(20,cot_2$Match_T2_Guest[j]) 
    
    
  }
  
  for (j in 1:nrow(cot_2))
  {
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    # cot_2$Plus_Corners_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HC),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AC))/cot_2$Match_T1_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Plus_Corners_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HC,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AC))
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Plus_Corners_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AC),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HC))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    cot_2$W_Plus_Corners_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AC,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HC))
    
    # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Plus_Corners_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HC),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AC))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Corners_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HC),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AC))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Corners_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HC),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AC))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_Corners_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HC),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AC))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Corners_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HC),
    #                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                     abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                             ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AC))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Corners_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HC),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AC))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Corners_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HC),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AC))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_Corners_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HC),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AC))/min(20,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Corners_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HC)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Corners_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HC)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Corners_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HC)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_Corners_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HC)/min(20,cot_2$Match_T1_Home[j])
    # 
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Corners_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AC)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Corners_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AC)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Corners_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AC)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_Corners_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AC)/min(20,cot_2$Match_T2_Guest[j])
    

    
    
  }
  
  for (j in 1:nrow(cot_2))
  {  
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????        
    
    # cot_2$Minus_Corners_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AC),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HC))/cot_2$Match_T1_All[j]       
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ?????????????? 
    
    cot_2$W_Minus_Corners_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AC,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HC))
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Minus_Corners_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HC),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AC))/cot_2$Match_T2_All[j]
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    cot_2$W_Minus_Corners_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HC,
                                                     subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AC))
    
    # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Minus_Corners_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AC),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HC))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_Corners_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AC),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HC))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_Corners_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AC),
    #                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HC))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_Corners_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AC),
    #                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HC))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Corners_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AC),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HC))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Corners_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AC),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HC))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Corners_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AC),
    #                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HC))/min(15,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_Corners_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AC),
    #                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HC))/min(20,cot_2$Match_T2_All[j])
    # 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_corners_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AC)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_corners_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AC)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_corners_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                  ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AC)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_corners_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                  ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AC)/min(20,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Corners_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HC)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Corners_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HC)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Corners_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HC)/min(15,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_Corners_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                           abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HC)/min(20,cot_2$Match_T2_Guest[j])
    
    
  }
  
  for (j in 1:nrow(cot_2))
  {
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    # cot_2$Plus_YCards_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HY),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AY))/cot_2$Match_T1_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Plus_YCards_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HY,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AY))
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Plus_YCards_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AY),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HY))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Plus_YCards_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AY,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HY))
    
    # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Plus_YCards_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HY),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AY))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_YCards_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HY),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AY))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_YCards_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HY),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AY))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_YCards_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HY),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AY))/min(20,cot_2$Match_T1_All[j])
    # 
    #     # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_YCards_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HY),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AY))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_YCards_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HY),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AY))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_YCards_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HY),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AY))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_YCards_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HY),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AY))/min(20,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_YCards_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HY)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_YCards_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HY)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_YCards_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HY)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_YCards_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HY)/min(20,cot_2$Match_T1_Home[j])
    # 
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_YCards_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AY)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_YCards_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AY)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_YCards_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AY)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_YCards_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AY)/min(20,cot_2$Match_T2_Guest[j])
    
    
    
  }
  
  
  for (j in 1:nrow(cot_2))
  {  
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????        
    
    # cot_2$Minus_YCards_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AY),
    #                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HY))/cot_2$Match_T1_All[j]       
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ?????????????? 
    
    cot_2$W_Minus_YCards_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AY,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HY))
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Minus_YCards_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HY),
    #                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AY))/cot_2$Match_T2_All[j]
   
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    cot_2$W_Minus_YCards_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HY,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AY))
    
    # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Minus_YCards_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AY),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HY))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_YCards_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AY),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HY))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_YCards_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AY),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HY))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_YCards_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AY),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HY))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_YCards_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AY),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HY))/min(5,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_YCards_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AY),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HY))/min(10,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_YCards_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AY),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HY))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_YCards_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AY),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HY))/min(20,cot_2$Match_T2_All[j])
    # 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_YCards_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AY)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_YCards_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AY)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_YCards_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AY)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_YCards_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AY)/min(20,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_YCards_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HY)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_YCards_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HY)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_YCards_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HY)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_YCards_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HY)/min(20,cot_2$Match_T2_Guest[j])
    
    
  }
  
  for (j in 1:nrow(cot_2))
  {
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    # cot_2$Plus_RCards_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HR),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AR))/cot_2$Match_T1_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$W_Plus_RCards_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$HR,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$AR))
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Plus_RCards_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AR),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HR))/cot_2$Match_T2_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    cot_2$W_Plus_RCards_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$AR,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$HR))
    
    # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Plus_RCards_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HR),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AR))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_RCards_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HR),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AR))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_RCards_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HR),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AR))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Plus_RCards_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HR),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$AR))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_RCards_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HR),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AR))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_RCards_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                              ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HR),
    #                                 sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                      abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AR))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_RCards_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HR),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AR))/min(15,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Plus_RCards_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$HR),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AR))/min(20,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_RCards_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HR)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_RCards_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HR)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_RCards_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HR)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Plus_RCards_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$HR)/min(20,cot_2$Match_T1_Home[j])
    # 
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_RCards_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AR)/min(5,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_RCards_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AR)/min(10,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_RCards_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AR)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Plus_RCards_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$AR)/min(20,cot_2$Match_T2_Guest[j])
    
    
    
  }
  
  for (j in 1:nrow(cot_2))
  {  
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????        
    
    # cot_2$Minus_RCards_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AR),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HR))/cot_2$Match_T1_All[j]       
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????  
    
    cot_2$W_Minus_RCards_T1_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$AR,
                                                   subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$HR))
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    
    # cot_2$Minus_RCards_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HR),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AR))/cot_2$Match_T2_All[j]
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ?????????????? 
    
    cot_2$W_Minus_RCards_T2_All[j]<-weighted_mean(c(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$HR,
                                                    subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$AR))
    
    # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    # cot_2$Minus_RCards_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AR),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HR))/min(5,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_RCards_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AR),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HR))/min(10,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_RCards_T1_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AR),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=15)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HR))/min(15,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    # 
    # cot_2$Minus_RCards_T1_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AR),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$HR))/min(20,cot_2$Match_T1_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_RCards_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AR),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HR))/min(5,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_RCards_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
    #                                               ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AR),
    #                                  sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                       abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
    #                                               ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HR))/min(10,cot_2$Match_T2_All[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_RCards_T2_15M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AR),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=15)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HR))/min(15,cot_2$Match_T2_All[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    # 
    # cot_2$Minus_RCards_T2_20M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$AR),
    #                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=20)  &               
    #                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HR))/min(20,cot_2$Match_T2_All[j]) 
    # 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_RCards_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AR)/min(5,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_RCards_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                        abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
    #                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AR)/min(10,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_RCards_T1_15M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=15) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AR)/min(15,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    # 
    # cot_2$Minus_RCards_T1_20M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=20) & 
    #                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$AR)/min(20,cot_2$Match_T1_Home[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_RCards_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HR)/min(5,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_RCards_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                         abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
    #                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HR)/min(10,cot_2$Match_T2_Guest[j]) 
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_RCards_T2_15M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=15) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HR)/min(15,cot_2$Match_T2_Guest[j])
    # 
    # # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    # 
    # cot_2$Minus_RCards_T2_20M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
    #                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=20) & 
    #                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$HR)/min(20,cot_2$Match_T2_Guest[j])
    # 
    
  }
 
  result<-rbind(result,cot_2) 
  
}
  
result$League_Flag<-ifelse(result$League=="France",1,
                    ifelse(result$League=="Germany",2,
                    ifelse(result$League=="Italy",3,
                    ifelse(result$League=="England",4,5))))

write.csv(result, "Factors_Calculation_Data_SK_New.csv", row.names = FALSE)
  
    
