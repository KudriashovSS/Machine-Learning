

setwd("C:/Users/skudriashov/Documents/Cotirovki/Machine_Learning/Baseball")
cot<-read.csv("TEST.csv",sep=",",h=T)
cot$Date<-as.Date(cot$Date,"%m/%d/%Y")  
cot<-cot[with(cot,order(cot$Date)),]


result<-data.frame()

n<-5


for (i in 1:length(unique(cot$Season_Flag)))
{
  
  cot_2<-subset(cot, cot$Season_Flag==unique(cot$Season_Flag)[i])
  
  
  for (j in 1:nrow(cot_2))
  {
    
    
    
    # ???????????????????? ?????????????????? ???????????? ?????? 1 ??????????????
    
    cot_2$Match_T1_All[j]<-nrow(rbind(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))),
                                      subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))))
    
    # ???????????????????? ?????????????????? ???????????? ?????? 2 ??????????????
    
    cot_2$Match_T2_All[j]<-nrow(rbind(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))),
                                      subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))))
    
   
    # ???????????????????? ?????????????????? ???????????????? ???????????? ?????? 1 ??????????????
    
    cot_2$Match_T1_Home[j]<-nrow(subset(cot_2, cot_2$Date<cot_2$Date[j] & cot_2$Team_1==cot_2$Team_1[j]))
    
    
    # ???????????????????? ?????????????????? ???????????????? ???????????? ?????? 2 ??????????????
    
    
    cot_2$Match_T2_Guest[j]<-nrow(subset(cot_2, cot_2$Date<cot_2$Date[j] & cot_2$Team_2==cot_2$Team_2[j]))
    
    # ???????????????????? ?????????????????? ???????????? ?????? 1 ??????????????
    
    cot_2$Match_T1_T2_All[j]<-nrow(rbind(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1Team_2)==as.character(cot_2$Team_1Team_2[j]))))),
                                         subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1Team_2)==as.character(cot_2$Team_2Team_1[j])))))))
    
    # ???????????????????? ?????????????????? ???????????????? ???????????? ?????? 1 ??????????????
    
    cot_2$Match_T1_T2_Home[j]<-nrow(subset(cot_2, cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1Team_2)==as.character(cot_2$Team_1Team_2[j])))))
    
  }
  
  
  
  
  ########################################################################## ???????? ####################################################################
  for (j in 1:nrow(cot_2))
  {
    
    # ???????????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$Points_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Points_1),
                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Points_2))/cot_2$Match_T1_All[j]
    
    
    
    
    # ???????????????????? ?????????? ?????? 2 ??????????????
    
    
    cot_2$Points_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Points_2),
                                sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Points_1))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    cot_2$Points_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Points_1),
                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                    abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
                                            ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Points_2))/5
    
    # ???????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    
    cot_2$Points_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
                                            ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Points_1),
                               sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                    abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
                                            ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Points_2))/5
    
    # ???????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Points_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                     abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
                                             ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Points_1)/5
    
    
    # ???????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Points_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                      abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
                                              ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Points_2)/5
    
    
    
  } 
  ##################################################################### ?????????????? ???????? ####################################################################
  
  for (j in 1:nrow(cot_2))
  {
    
    # ???????????????????? ?????????????? ?????????? ?????? 1 ??????????????
    
    cot_2$Plus_Goals_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Goal_1),
                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Goal_2))/cot_2$Match_T1_All[j]  
    
    # ???????????????????? ?????????????? ?????????? ?????? 2 ??????????????
    
    
    cot_2$Plus_Goals_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Goal_2),
                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Goal_1))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    cot_2$Plus_Goals_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_1),
                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Goal_2))/5
    
    # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    
    cot_2$Plus_Goals_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Goal_1),
                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_2))/5
    
    # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Plus_Goals_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_1)/5
    
    
    # ???????????????????? ?????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Plus_Goals_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_2)/5
    
    
    
  }     
  ##################################################################### ?????????????????????? ???????? ####################################################################      
  for (j in 1:nrow(cot_2))
  {  
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 1 ??????????????        
    
    cot_2$Minus_Goals_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Goal_2),
                                     sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Goal_1))/cot_2$Match_T1_All[j]       
    
    # ???????????????????? ?????????????????????? ?????????? ?????? 2 ??????????????
    
    
    cot_2$Minus_Goals_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Goal_1),
                                     sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Goal_2))/cot_2$Match_T2_All[j]
    
    # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    cot_2$Minus_Goals_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                         abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_2),
                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                         abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Goal_1))/5
    
    # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    
    cot_2$Minus_Goals_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                         abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Goal_2),
                                    sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                         abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
                                                 ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_1))/5          
    
    
    # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Minus_Goals_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
                                                  ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Goal_2)/5
    
    # ???????????????????? ?????????????????????? ?????????? ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Minus_Goals_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Goal_1)/5        
    
    
  }
  
  
  ##################################################################### ???????????? ####################################################################    
  
  ##################################################################### ???????????? 8 ?? ####################################################################     
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ?????? 1 ??????????????        
    
    cot_2$Total_more_8_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_8),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_8))/cot_2$Match_T1_All[j]           
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ?????? 2 ?????????????? 
    
    
    cot_2$Total_more_8_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_8),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_8))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    cot_2$Total_more_8_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
                                                  ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_8),
                                     sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_8))/5
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    
    cot_2$Total_more_8_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
                                                  ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_8),
                                     sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_8))/5  
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Total_more_8_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_8)/5
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 1.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Total_more_8_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                            abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_8)/5    
    
  }
  

  ##################################################################### ???????????? 9 ?? ####################################################################       
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ?????? 1 ??????????????        
    
    cot_2$Total_more_9_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_9),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_9))/cot_2$Match_T1_All[j]           
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ?????? 2 ?????????????? 
    
    
    cot_2$Total_more_9_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_9),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_9))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    cot_2$Total_more_9_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
                                                  ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_9),
                                     sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_9))/5 
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    
    cot_2$Total_more_9_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
                                                  ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_9),
                                     sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_9))/5  
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Total_more_9_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_9)/5
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 2.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Total_more_9_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                            abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_9)/5   
    
  }
  
  ##################################################################### ???????????? 10 ?? ####################################################################   
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ?????? 1 ??????????????        
    
    cot_2$Total_more_10_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_10),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_10))/cot_2$Match_T1_All[j]           
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ?????? 2 ?????????????? 
    
    
    cot_2$Total_more_10_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_10),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_10))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    cot_2$Total_more_10_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
                                                  ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_10),
                                     sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_10))/5 
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    
    cot_2$Total_more_10_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
                                                  ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_10),
                                     sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_10))/5  
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Total_more_10_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_10)/5
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Total_more_10_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                            abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
                                                    ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_10)/5    
    
  }
  
  ##################################################################### ???????????? 11 ?? ####################################################################   
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ?????? 1 ??????????????        
    
    cot_2$Total_more_11_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Total_more_11),
                                       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Total_more_11))/cot_2$Match_T1_All[j]           
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ?????? 2 ?????????????? 
    
    
    cot_2$Total_more_11_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Total_more_11),
                                       sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Total_more_11))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    cot_2$Total_more_11_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_11),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Total_more_11))/5 
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    
    cot_2$Total_more_11_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Total_more_11),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_11))/5  
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Total_more_11_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                            abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Total_more_11)/5
    
    # ???????????????????? ???????????? ?? ?????????? ?????????? ???????????? 3.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Total_more_11_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                             abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
                                                     ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Total_more_11)/5    
    
  }
  
  
  
  ##################################################################### ???????????????????????????? ???????????? 4 ?? #################################################################### 
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 1 ??????????????        
    
    cot_2$Ind_Total_more_4_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Ind_total_Team1_more_4),
                                          sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Ind_total_Team2_more_4))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 2 ?????????????? 
    
    
    cot_2$Ind_Total_more_4_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Ind_total_Team2_more_4),
                                          sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Ind_total_Team1_more_4))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    cot_2$Ind_Total_more_4_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_4),
                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_4))/5 
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    
    cot_2$Ind_Total_more_4_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_4),
                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_4))/5  
    
    # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Ind_Total_more_4_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                               abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
                                                       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_4)/5
    
    # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Ind_Total_more_4_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                                abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
                                                        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_4)/5   
    
  }
  ##################################################################### ???????????????????????????? ???????????? 5 ?? #################################################################### 
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 1 ??????????????        
    
    cot_2$Ind_Total_more_5_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Ind_total_Team1_more_5),
                                          sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Ind_total_Team2_more_5))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 2 ?????????????? 
    
    
    cot_2$Ind_Total_more_5_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Ind_total_Team2_more_5),
                                          sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Ind_total_Team1_more_5))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    cot_2$Ind_Total_more_5_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_5),
                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_5))/5 
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    
    cot_2$Ind_Total_more_5_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_5),
                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_5))/5  
    
    # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Ind_Total_more_5_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                               abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
                                                       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_5)/5
    
    # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Ind_Total_more_5_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                                abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
                                                        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_5)/5   
    
  }
  
  ##################################################################### ???????????????????????????? ???????????? 6 ?? #################################################################### 
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 1 ??????????????        
    
    cot_2$Ind_Total_more_6_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Ind_total_Team1_more_6),
                                          sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Ind_total_Team2_more_6))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 2 ?????????????? 
    
    
    cot_2$Ind_Total_more_6_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Ind_total_Team2_more_6),
                                          sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Ind_total_Team1_more_6))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    cot_2$Ind_Total_more_6_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_6),
                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_6))/5 
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    
    cot_2$Ind_Total_more_6_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_6),
                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_6))/5  
    
    # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Ind_Total_more_6_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                               abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
                                                       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_6)/5
    
    # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Ind_Total_more_6_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                                abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
                                                        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_6)/5   
    
  }
  
  
  ##################################################################### ???????????????????????????? ???????????? 7 ?? #################################################################### 
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 1 ??????????????        
    
    cot_2$Ind_Total_more_7_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Ind_total_Team1_more_7),
                                          sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Ind_total_Team2_more_7))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ?????? 2 ?????????????? 
    
    
    cot_2$Ind_Total_more_7_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Ind_total_Team2_more_7),
                                          sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Ind_total_Team1_more_7))/cot_2$Match_T2_All[j]  
    
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 1 ??????????????
    
    cot_2$Ind_Total_more_7_T1_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5) & 
                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_7),
                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=5)  &               
                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Ind_total_Team2_more_7))/5 
    
    # ???????????????????? ???????????? ?? ?????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ?????? ?????? 2 ??????????????  
    
    cot_2$Ind_Total_more_7_T2_5M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5) & 
                                                      ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_7),
                                         sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                              abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=5)  &               
                                                      ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team1_more_7))/5  
    
    # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Ind_Total_more_7_T1_5M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                               abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=5) & 
                                                       ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Ind_total_Team1_more_7)/5
    
    # ???????????????????? ???????????? ?? ???????????????????????????? ?????????????? ?????????? ???????????? 0.5 ???? ?????????????????? 5 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Ind_Total_more_7_T2_5M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                                abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=5) & 
                                                        ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Ind_total_Team2_more_7)/5   
    
  }
  
  ##################################################################### ???????????? ####################################################################  
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ?????????? ?????? 1 ??????????????        
    
    cot_2$Total_Win_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_Win),
                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_Defeat))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ?????????? ?????? 2 ?????????????? 
    
    
    cot_2$Total_Win_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_Defeat),
                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_Win))/cot_2$Match_T2_All[j]  
    
    # # ???????????????????? ?????????? ?????????????? 1 ?? ???????????? ???????????????? 
    # 
    # 
    # cot_2$Total_Win_T1_T2_All[j]<-mean(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1Team_2)==as.character(cot_2$Team_1Team_2[j])))))$Flag_Win)   
    
    
    # ???????????????????? ?????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    
    cot_2$Total_Win_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Win),
                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                        abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Defeat))/min(min(cot_2$Match_T1_All[j],10),max(cot_2$Match_T1_All[j],10)) 
    
    # ???????????????????? ?????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    
    cot_2$Total_Win_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
                                                ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Win),
                                   sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                        abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
                                                ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Defeat))/min(min(cot_2$Match_T2_All[j],10),max(cot_2$Match_T2_All[j],10))  
    
    # ???????????????????? ?????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Total_Win_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                         abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
                                                 ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Win)/min(min(cot_2$Match_T1_Home[j],10),max(cot_2$Match_T1_Home[j],10))
    
    # ???????????????????? ?????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Total_Win_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                          abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
                                                  ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Defeat)/min(min(cot_2$Match_T2_Guest[j],10),max(cot_2$Match_T2_Guest[j],10)) 
    
    # ???????????????????? ?????????? ?????????????? 1 ?? ???????????? ???????????????? 
    
    
    cot_2$Total_Win_T1_T2_All[j]<-sum(sum(subset(cot_2,      (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1Team_2)==as.character(cot_2$Team_1Team_2[j])))))$Flag_Win),
                                      sum(subset(cot_2,      (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1Team_2)==as.character(cot_2$Team_2Team_1[j])))))$Flag_Defeat))/cot_2$Match_T1_T2_All[j]   
    
    # ???????????????????? ???????????????? ?????????? ?????????????? 1 ?? ???????????? ???????????????? 
    
    cot_2$Total_Win_T1_T2_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1Team_2)==as.character(cot_2$Team_1Team_2[j])))))$Flag_Win)/cot_2$Match_T1_T2_Home[j]
    
  }  
  
  
  
  ##################################################################### ?????????????????? ####################################################################  
  
  for (j in 1:nrow(cot_2))
  { 
    
    # ???????????????????? ?????????????????? ?????? 1 ??????????????        
    
    cot_2$Total_Defeat_T1_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j])))))$Flag_Defeat),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j])))))$Flag_Win))/cot_2$Match_T1_All[j]            
    
    # ???????????????????? ?????????????????? ?????? 2 ?????????????? 
    
    
    cot_2$Total_Defeat_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j])))))$Flag_Win),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j])))))$Flag_Defeat))/cot_2$Match_T2_All[j]   
    
    # # ???????????????????? ?????????????????? ?????????????? 1 ?? ???????????? ???????????????? 
    # 
    # 
    # cot_2$Total_Defeat_T1_T2_All[j]<-mean(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1Team_2)==as.character(cot_2$Team_1Team_2[j])))))$Flag_Defeat) 
    
    # ???????????????????? ?????????????????? ???? ?????????????????? 10 ?????? ?????? 1 ??????????????
    
    cot_2$Total_Defeat_T1_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10) & 
                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Defeat),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T1_All-cot_2$Match_T1_All[j])<=10)  &               
                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_1[j]))))$Flag_Win))/min(min(cot_2$Match_T1_All[j],10),max(cot_2$Match_T1_All[j],10))  
    
    # ???????????????????? ?????????????????? ???? ?????????????????? 10 ?????? ?????? 2 ??????????????  
    
    cot_2$Total_Defeat_T2_10M[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10) & 
                                                   ((as.character(cot_2$Team_1)==as.character(cot_2$Team_2[j]))))$Flag_Defeat),
                                      sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                           abs(cot_2$Match_T2_All-cot_2$Match_T2_All[j])<=10)  &               
                                                   ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Win))/min(min(cot_2$Match_T2_All[j],10),max(cot_2$Match_T2_All[j],10))  
    
    # ???????????????????? ?????????????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 1 ??????????????  
    
    cot_2$Total_Defeat_T1_10M_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                            abs(cot_2$Match_T1_Home-cot_2$Match_T1_Home[j])<=10) & 
                                                    ((as.character(cot_2$Team_1)==as.character(cot_2$Team_1[j]))))$Flag_Defeat)/min(min(cot_2$Match_T1_Home[j],10),max(cot_2$Match_T1_Home[j],10))
    
    # ???????????????????? ?????????????????? ???? ?????????????????? 10 ???????????????? ?????? ?????? 2 ??????????????   
    
    cot_2$Total_Defeat_T2_10M_Guest[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & 
                                                             abs(cot_2$Match_T2_Guest-cot_2$Match_T2_Guest[j])<=10) & 
                                                     ((as.character(cot_2$Team_2)==as.character(cot_2$Team_2[j]))))$Flag_Win)/min(min(cot_2$Match_T2_Guest[j],10),max(cot_2$Match_T2_Guest[j],10))
    
    # ???????????????????? ?????????????????? ?????????????? 1 ?? ???????????? ???????????????? 
    
    
    cot_2$Total_Defeat_T1_T2_All[j]<-sum(sum(subset(cot_2, (cot_2$Date<cot$Date[j] & ((as.character(cot_2$Team_1Team_2)==as.character(cot_2$Team_1Team_2[j])))))$Flag_Defeat),
                                         sum(subset(cot_2, (cot_2$Date<cot$Date[j] & ((as.character(cot_2$Team_1Team_2)==as.character(cot_2$Team_2Team_1[j])))))$Flag_Win))/cot_2$Match_T1_T2_All[j]   
    
    # ???????????????????? ???????????????? ?????????????????? ?????????????? 1 ?? ???????????? ???????????????? 
    
    cot_2$Total_Defeat_T1_T2_Home[j]<-sum(subset(cot_2, (cot_2$Date<cot_2$Date[j] & ((as.character(cot_2$Team_1Team_2)==as.character(cot_2$Team_1Team_2[j])))))$Flag_Defeat)/cot_2$Match_T1_T2_Home[j]
    
  }
  
  
  result<-rbind(result,cot_2) 
  
}
.
write.csv(result, "Factors_Calculation_All_Season_Baseball_TEST.csv")

